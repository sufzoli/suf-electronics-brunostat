<!DOCTYPE HTML>
<html>
	<head>
	</head>
	<body>
		<h1>BrunoSthat</h1>
		<iframe id="ct_frame" height="100" width="200" src="/currenttemp" frameBorder="0"></iframe>
		<iframe id="st_frame" height="0" width="0" src="/settemp" style="visibility:hidden;display:none" onload="get_target_temp();"></iframe>
		<form>
			<input type="text" id="set_temp" value="" />
			<b>&deg;C</b>
			<input type="button" name="btn_up" value="&#x25B2;" onclick="change_temp(5);" />
			<input type="button" name="btn_down" value="&#x25BC;" onclick="change_temp(-5);" />
			<input type="button" name="btn_set" value="SET" onclick="set_temp();" />
		</form>
		<script type="text/javascript">
			function get_temp_value()
			{
				var temp_box = document.getElementById('set_temp');
				// alert(temp_box.value.replace('.',''));
				return parseInt(temp_box.value.replace('.',''));
			}
			function set_temp_value(value)
			{
				var temp_box = document.getElementById('set_temp');
				var temp_str = value.toString();
				
				temp_box.value = temp_str.substr(0,temp_str.length-1) + '.' + temp_str.substr(temp_str.length-1,1);
			}
			function change_temp(value)
			{
				var temp_int = get_temp_value();
				set_temp_value(temp_int + value);
			}
			function set_temp()
			{
				document.getElementById('st_frame').src = '/settemp=' + document.getElementById('set_temp').value.replace('.','');
			}
			
			function get_target_temp()
			{
			    var target_frame = document.getElementById('st_frame');
			    var temp_box = document.getElementById('set_temp');
			    // using reference to iframe (ifrm) obtained above
			    var win = target_frame.contentWindow; // reference to iframe's window
			    // reference to document in iframe
			    var doc = target_frame.contentDocument? target_frame.contentDocument: target_frame.contentWindow.document;
			    // reference to form named 'demoForm' in iframe
			    var ret_temp = doc.getElementById('ret_temp');
			    set_temp_value(ret_temp.innerHTML.replace(' ',''));
			}
			
		</script>

	</body>
</html>